import{d as _,m as f,h as n,o as A,e as E,q as g,a8 as L,i as T,a as o,g as i,t as U,v as x,aa as V,F as N,b as P}from"./index-D67faS8Z.js";import{N as S}from"./notyf.min-ll9y_k96.js";import{g as B,c as j,T as M,b as R,u as $}from"./index.esm2017-CZwVnIW6.js";import{_ as q}from"./AnnouncementCard.vue_vue_type_script_setup_true_lang-D3QIOtc7.js";const H={class:"max-w-4xl p-6 mx-auto mt-10 bg-white rounded-lg shadow-md font-poppins"},K={class:"mb-4"},O={class:"mb-4"},z={class:"mb-4"},G={class:"grid w-full max-w-xs items-center gap-1.5"},J={class:"flex items-center mt-3 mb-4"},Q=_({__name:"AnnouncementComponent",setup(W){const u=new S({duration:4e3,dismissible:!0,position:{x:"left",y:"top"},ripple:!0}),d=f(""),c=f(""),m=f(!1),p=f(""),b=f(null),v=a=>{const e=a.target;e.files&&e.files[0]&&(b.value=e.files[0])},w=async a=>{const e="6d207e02198a847aa98d0a2a901485a5",t="https://cors-anywhere.herokuapp.com/",k="https://freeimage.host/api/1/upload",D=l=>new Promise((r,y)=>{const s=new FileReader;s.readAsDataURL(l),s.onload=()=>r(s.result),s.onerror=F=>y(F)});n().setIsLoadingComponent(!0);try{const l=await D(a),r=new FormData;r.append("key",e),r.append("action","upload"),r.append("source",l.includes(",")?l.split(",")[1]:l),r.append("format","json");const s=await(await fetch(t+k,{method:"POST",body:r})).json();return s.status_code===200?(console.log("Imagen subida exitosamente:",s.image.display_url),n().setIsLoadingComponent(!1),u.success("Imagen subida exitosamente"),s.image.display_url):(console.error("Error al subir la imagen:",s.status_txt),n().setIsLoadingComponent(!1),u.error("Error al subir la imagen"),null)}catch(l){return console.error("Error durante la subida:",l),n().setIsLoadingComponent(!1),u.error("Error al subir la imagen"),null}},I=B(),h=j(I,`condominios/${n().getCondominiumId}/announcements`),C=async()=>{n().setIsLoadingComponent(!0);let a="";if(b.value&&(a=await w(b.value),!a)){n().setIsLoadingComponent(!1),u.error("Error al subir la imagen.");return}const e={title:d.value,description:c.value,category:p.value,urgent:m.value,imageUrl:a,creationDate:M.now()};try{const t=await R(h,e);await $(t,{announcementId:t.id}),d.value="",c.value="",p.value="",b.value=null,m.value=!1,u.success("Posteado exitosamente")}catch{u.error("Error al postear el anuncio")}finally{n().setIsLoadingComponent(!1)}};return(a,e)=>(A(),E(N,null,[g(T(q,{class:"fixed shadow-2xl bottom-3 left-3",title:d.value,description:c.value,date:new Date().toDateString(),category:p.value,"is-urgent":m.value},null,8,["title","description","date","category","is-urgent"]),[[L,d.value]]),o("section",H,[e[10]||(e[10]=o("h2",{class:"mb-4 text-2xl font-bold text-sky-800"},[o("i",{class:"fas fa-bullhorn"}),i(" Nuevo Anuncio")],-1)),o("form",{onSubmit:U(C,["prevent"])},[o("div",K,[e[4]||(e[4]=o("label",{for:"titulo",class:"block mb-2 font-bold text-sky-800"},[o("i",{class:"fas fa-heading"}),i(" Título del Anuncio")],-1)),g(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),type:"text",id:"titulo",name:"titulo",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el título del anuncio"},null,512),[[x,d.value]])]),o("div",O,[e[5]||(e[5]=o("label",{for:"category",class:"block mb-2 font-bold text-sky-800"},[o("i",{class:"fas fa-tag"}),i(" Categoría del Anuncio")],-1)),g(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>p.value=t),type:"text",id:"category",name:"category",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la categoría del anuncio e.g. Pago de mantenimiento, etc."},null,512),[[x,p.value]])]),o("div",z,[e[6]||(e[6]=o("label",{for:"descripcion",class:"block mb-2 font-bold text-sky-800"},[o("i",{class:"fas fa-align-left"}),i(" Descripción")],-1)),g(o("textarea",{"onUpdate:modelValue":e[2]||(e[2]=t=>c.value=t),id:"descripcion",name:"descripcion",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la descripción del anuncio"},null,512),[[x,c.value]])]),o("div",G,[e[7]||(e[7]=o("label",{class:"text-sm font-medium leading-none text-gray-400 peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},[o("i",{class:"mr-2 fas fa-image text-sky-600"}),i(" Imagen")],-1)),o("input",{class:"flex w-full text-sm text-gray-400 bg-white border border-blue-300 rounded-md border-input file:border-0 file:bg-blue-600 file:text-white file:text-sm file:font-medium",type:"file",id:"picture",onChange:v},null,32)]),o("div",J,[g(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>m.value=t),type:"checkbox",id:"urgente",name:"urgente",class:"mr-2"},null,512),[[V,m.value]]),e[8]||(e[8]=o("label",{for:"urgente",class:"font-bold cursor-pointer text-sky-800"},[o("i",{class:"fas fa-exclamation-circle"}),i(" ¿Es Urgente?")],-1))]),e[9]||(e[9]=o("div",{class:"flex justify-end"},[o("button",{type:"submit",class:"px-4 py-2 text-white bg-blue-500 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"},[o("i",{class:"fas fa-plus"}),i(" Crear Anuncio ")])],-1))],32)])],64))}}),oe=P(Q,[["__scopeId","data-v-083375c6"]]);export{oe as default};
