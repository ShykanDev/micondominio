import{d as D,r as m,s as C,o as A,f as F,e as f,a3 as _,k as T,a as t,n as i,j as U,v as g,a5 as V,F as E,i as S}from"./index-CvqitIG0.js";import{g as j,c as B,T as N,b as P,u as M}from"./index.esm2017-pqe3CByq.js";import{_ as R}from"./AnnouncementCard.vue_vue_type_script_setup_true_lang-B6VNm6Mw.js";const $={class:"max-w-4xl p-6 mx-auto mt-10 bg-white rounded-lg shadow-md font-poppins"},H={class:"mb-4"},K={class:"mb-4"},L={class:"mb-4"},O={class:"grid w-full max-w-xs items-center gap-1.5"},q={class:"flex items-center mt-3 mb-4"},z=D({__name:"AnnouncementComponent",setup(G){const r=m(""),u=m(""),d=m(!1),c=m(""),p=m(null),x=n=>{const e=n.target;e.files&&e.files[0]&&(p.value=e.files[0])},v=async n=>{const e="6d207e02198a847aa98d0a2a901485a5",o="https://freeimage.host/api/1/upload",h=s=>new Promise((l,b)=>{const a=new FileReader;a.readAsDataURL(s),a.onload=()=>l(a.result),a.onerror=I=>b(I)});try{const s=await h(n),l=new FormData;l.append("key",e),l.append("action","upload"),l.append("source",s.includes(",")?s.split(",")[1]:s),l.append("format","json");const a=await(await fetch(o,{method:"POST",body:l})).json();return a.status_code===200?(console.log("Imagen subida exitosamente:",a.image.display_url),a.image.display_url):(console.error("Error al subir la imagen:",a.status_txt),null)}catch(s){return console.error("Error durante la subida:",s),null}},y=j(),w=B(y,`condominios/${C().getCondominiumId}/announcements`),k=async()=>{if(!p.value){alert("Por favor selecciona una imagen.");return}const n=await v(p.value);if(!n){alert("Error al subir la imagen.");return}const e={title:r.value,description:u.value,category:c.value,urgent:d.value,imageUrl:n,creationDate:N.now()},o=await P(w,e);await M(o,{announcementId:o.id}),r.value="",u.value="",c.value="",p.value=null,d.value=!1,console.log("Anuncio creado con ID:",n)};return(n,e)=>(A(),F(E,null,[f(T(R,{class:"fixed shadow-2xl bottom-3 left-3",title:r.value,description:u.value,date:new Date().toDateString(),category:c.value,"is-urgent":d.value},null,8,["title","description","date","category","is-urgent"]),[[_,r.value]]),t("section",$,[e[10]||(e[10]=t("h2",{class:"mb-4 text-2xl font-bold text-sky-800"},[t("i",{class:"fas fa-bullhorn"}),i(" Nuevo Anuncio")],-1)),t("form",{onSubmit:U(k,["prevent"])},[t("div",H,[e[4]||(e[4]=t("label",{for:"titulo",class:"block mb-2 font-bold text-sky-800"},[t("i",{class:"fas fa-heading"}),i(" Título del Anuncio")],-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),type:"text",id:"titulo",name:"titulo",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el título del anuncio"},null,512),[[g,r.value]])]),t("div",K,[e[5]||(e[5]=t("label",{for:"category",class:"block mb-2 font-bold text-sky-800"},[t("i",{class:"fas fa-tag"}),i(" Categoría del Anuncio")],-1)),f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>c.value=o),type:"text",id:"category",name:"category",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la categoría del anuncio e.g. Pago de mantenimiento, etc."},null,512),[[g,c.value]])]),t("div",L,[e[6]||(e[6]=t("label",{for:"descripcion",class:"block mb-2 font-bold text-sky-800"},[t("i",{class:"fas fa-align-left"}),i(" Descripción")],-1)),f(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>u.value=o),id:"descripcion",name:"descripcion",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la descripción del anuncio"},null,512),[[g,u.value]])]),t("div",O,[e[7]||(e[7]=t("label",{class:"text-sm font-medium leading-none text-gray-400 peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},[t("i",{class:"mr-2 fas fa-image text-sky-600"}),i(" Imagen")],-1)),t("input",{class:"flex w-full text-sm text-gray-400 bg-white border border-blue-300 rounded-md border-input file:border-0 file:bg-blue-600 file:text-white file:text-sm file:font-medium",type:"file",id:"picture",onChange:x},null,32)]),t("div",q,[f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>d.value=o),type:"checkbox",id:"urgente",name:"urgente",class:"mr-2"},null,512),[[V,d.value]]),e[8]||(e[8]=t("label",{for:"urgente",class:"font-bold text-sky-800"},[t("i",{class:"fas fa-exclamation-circle"}),i(" ¿Es Urgente?")],-1))]),e[9]||(e[9]=t("div",{class:"flex justify-end"},[t("button",{type:"submit",class:"px-4 py-2 text-white bg-blue-500 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"},[t("i",{class:"fas fa-plus"}),i(" Crear Anuncio ")])],-1))],32)])],64))}}),X=S(z,[["__scopeId","data-v-1119097f"]]);export{X as default};
