import{d as T,r as l,o as x,f as k,a as o,l as W,g as N,e as u,v as p,m as Y,n as V,j as _,F as J,s as K,c as Q,w as X,_ as Z,k as ee}from"./index-B3vvVhEK.js";import{g as oe,c as te,u as M,a as j}from"./index-2cab5241-s7nkthZ2.js";import{g as ae,c as v,a as L,b as w,T as C,u as U,q as se,w as ne}from"./index.esm2017-waQ9Feby.js";import{N as ie}from"./notyf.min-ll9y_k96.js";const le={class:"font-roboto font-poppins"},re={key:0,class:"fixed top-0 bottom-0 left-0 right-0 z-40 flex flex-col items-center justify-center transition-opacity duration-500 ease-in-out bg-white bg-opacity-100 animate-fade"},ue={class:"flex items-center justify-center px-3 py-2 bg-white bg-opacity-50"},de={class:"w-full max-w-4xl p-8 bg-white rounded-lg shadow-lg"},ce={class:"mb-4"},me={class:"relative"},fe={class:"mb-4"},pe={class:"relative"},ve={key:0,class:"mb-4 animate-fade-up"},be={class:"relative"},ge={key:1,class:"mb-4 animate-fade-up"},ye={class:"relative"},we={key:2,class:"mb-4 animate-fade-up"},xe={class:"relative"},ke={class:"mb-4"},Ce={class:"relative"},Ie={class:"mb-4"},qe={class:"relative"},De={class:"mb-4"},Ne={class:"relative"},Ve={class:"mb-6"},Ue=T({__name:"RegisterCard",setup(F){const n=l(!1),d=new ie({position:{x:"center",y:"top"},dismissible:!0,duration:5e3}),r=l(""),b=l(""),a=l(""),R=l(""),c=l(""),g=l(""),I=l(""),q=l(""),G=oe(),m=ae(),A=l(""),$=()=>{const f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let t=0;t<8;t++){const s=Math.floor(Math.random()*f.length);e+=f.charAt(s)}return e},S=v(m,"condominios"),H=v(m,"usersGeneral"),O=async()=>{try{if(!r.value||!b.value||!c.value||!g.value||!a.value){d.error("Por favor, completa todos los campos.");return}if(c.value!==g.value){d.error("Las contraseñas no coinciden.");return}if(n.value=!0,I.value=$(),(await L(S)).docs.map(i=>i.data()).some(i=>i.invitationId===I.value)){d.error("Error al generar el ID de invitación. Inténtelo de nuevo"),I.value=$(),n.value=!1;return}const s=(await te(G,b.value,c.value)).user;if(s&&a.value.toLowerCase()=="administrador"){await M(s,{displayName:`${a.value} ${r.value}`}),await j(s);const i=await w(v(m,"condominios"),{name:R.value,createdBy:s.uid,type:a.value,invitationId:I.value,dateCreated:C.fromDate(new Date),condominiumId:""});await U(i,{condominiumId:i.id});const D=v(m,`condominios/${i.id}/announcements`),y=v(m,`condominios/${i.id}/comments`),B=v(m,`condominios/${i.id}/surveys`),h=await w(D,{title:"Bienvenidos",content:"Este es el primer anuncio de tu condominio.",author:s.displayName,date:new Date,isUrgent:!1,fromAdmin:!1}),z=h.id;U(h,{announcementId:z});const P=await w(y,{announcement:"Primer comentario generado automáticamente",category:"Inquilinos",date:C.now(),author:s.displayName,isUrgent:!1,fromAdmin:!1});await U(P,{documentId:P.id});const E=await w(B,{title:"Encuesta de prueba",description:"Esta es una encuesta de prueba, sus inquilinos podrán votar en ella",options:["Opcion 1","Opcion 2","Opcion 3"],createdBy:K().getUserUid,creationDate:C.now()});await U(E,{surveyDocId:E.id}),d.success({message:"Registro exitoso. Por favor, verifique su correo electrónico, le hemos enviado un correo de verificación.",duration:7e3}),r.value="",b.value="",c.value="",g.value="",a.value="",n.value=!1}else if(s&&a.value.toLowerCase()=="propietario"){n.value=!0,await M(s,{displayName:`${a.value} ${r.value}`}),await j(s),d.success({message:"Registro exitoso. Por favor, verifique su correo electrónico, le hemos enviado un correo de verificación.",duration:7e3});const i=se(S,ne("invitationId","==",A.value.trim())),D=await L(i);if(D.empty){console.log("No se enocontró ese código de invitación"),n.value=!1;return}else{for(const y of D.docs){console.log(`Se encontró el código de invitación: ${y.data().invitationId}, con el id del documento: ${y.id}`);const B=v(m,`condominios/${y.id}/usuarios`);await w(B,{name:r.value,deptNumber:q.value,creationDate:C.now(),isBlocked:!1,blockedReason:"",allowComments:!0,userUid:s.uid,associatedTo:y.data().createdBy}),await w(H,{deptNumber:q.value,creationDate:C.now(),userUid:s.uid}),n.value=!1}n.value=!1}r.value="",b.value="",c.value="",g.value="",a.value="",n.value=!1}}catch(f){const e=f;n.value=!1,console.log(f),d.error(e.message)}};return(f,e)=>(x(),k(J,null,[e[29]||(e[29]=o("img",{src:"https://images.unsplash.com/photo-1576961453646-b4c376c7021b?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",class:"fixed top-0 bottom-0 left-0 right-0 object-cover w-full h-full animate-fade -z-10",alt:"A scenic view of a modern building with a clear sky in the background"},null,-1)),o("section",le,[n.value?(x(),k("section",re,e[8]||(e[8]=[W('<p class="text-2xl font-semibold text-sky-800 font-poppins">Creando Cuenta <span class="animate-pulse animate-delay-0">.</span> <span class="animate-pulse animate-delay-300">.</span> <span class="animate-pulse animate-delay-400">.</span></p><div class="flex flex-col items-center justify-center w-full gap-4"><div class="flex items-center justify-center text-4xl text-blue-400 border-8 border-gray-300 rounded-full w-28 h-28 animate-spin border-t-blue-400"></div></div>',2)]))):N("",!0),o("div",ue,[o("div",de,[e[28]||(e[28]=o("h2",{class:"mb-6 text-4xl font-bold text-center text-sky-900"},"Crear una Cuenta",-1)),o("form",null,[o("div",ce,[e[10]||(e[10]=o("label",{for:"nombre",class:"block font-medium text-sky-900"},"Nombre",-1)),o("div",me,[u(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),type:"text",id:"nombre",name:"nombre",placeholder:"Ingresa tu nombre",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[p,r.value]]),e[9]||(e[9]=o("i",{class:"absolute text-sky-800 fas fa-user left-3 top-3"},null,-1))])]),o("div",fe,[e[13]||(e[13]=o("label",{for:"tipo-cuenta",class:"block font-medium text-sky-900"},"Tipo de Cuenta",-1)),o("div",pe,[u(o("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.value=t),id:"tipo-cuenta",name:"tipo-cuenta",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},e[11]||(e[11]=[o("option",{value:"",disabled:"",selected:""},"Selecciona el tipo de cuenta",-1),o("option",{value:"propietario"},"Propietario/Inquilino",-1),o("option",{value:"administrador"},"Administrador",-1)]),512),[[Y,a.value]]),e[12]||(e[12]=o("i",{class:"absolute text-sky-800 fas fa-user-tag left-3 top-3"},null,-1))]),e[14]||(e[14]=o("div",{class:"mt-2 text-sm text-gray-600"},[o("i",{class:"mr-1 fas fa-info-circle"}),V(" La cuenta por defecto es de "),o("strong",null,"Propietario/Inquilino"),V(". Seleccione "),o("strong",null,"Administrador"),V(" si usted es responsable de la administración de un edificio o condominio. ")],-1))]),a.value.toLowerCase()=="propietario"?(x(),k("div",ve,[e[16]||(e[16]=o("label",{for:"owner",class:"block font-medium text-sky-900"},"Número de departamento",-1)),o("div",be,[u(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>q.value=t),type:"email",id:"owner",name:"owner",placeholder:"Ingresa el número de departamento",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[p,q.value]]),e[15]||(e[15]=o("i",{class:"absolute text-sky-800 fas fa-hashtag left-3 top-3"},null,-1))])])):N("",!0),a.value.toLowerCase()=="propietario"?(x(),k("div",ge,[e[18]||(e[18]=o("label",{for:"invId",class:"block font-medium text-sky-900"},"Código de invitación",-1)),o("div",ye,[u(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>A.value=t),type:"email",id:"invId",name:"invId",placeholder:"Ingresa el código de invitación",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[p,A.value]]),e[17]||(e[17]=o("i",{class:"absolute text-sky-800 fas fa-address-card left-3 top-3"},null,-1))]),e[19]||(e[19]=o("div",null,[o("small",{class:"text-xs italic text-slate-500"},[o("i",{class:"mr-1 fas fa-info-circle"}),V("Ingresa el código de invitación de tu departamento, pregunta al administrador, por el código.")])],-1))])):N("",!0),a.value.toLowerCase()=="administrador"?(x(),k("div",we,[e[21]||(e[21]=o("label",{for:"condominium",class:"block font-medium text-sky-900"},"Nombre del Condominio",-1)),o("div",xe,[u(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>R.value=t),type:"email",id:"condominium",name:"condominium",placeholder:"Ingresa el nombre del condominio ",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[p,R.value]]),e[20]||(e[20]=o("i",{class:"absolute text-sky-800 fas fa-building left-3 top-3"},null,-1))])])):N("",!0),o("div",ke,[e[23]||(e[23]=o("label",{for:"correo",class:"block font-medium text-sky-900"},"Correo Electrónico",-1)),o("div",Ce,[u(o("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>b.value=t),type:"email",id:"correo",name:"correo",placeholder:"Ingresa tu correo electrónico",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[p,b.value]]),e[22]||(e[22]=o("i",{class:"absolute text-sky-800 fas fa-envelope left-3 top-3"},null,-1))])]),o("div",Ie,[e[25]||(e[25]=o("label",{for:"contrasena",class:"block font-medium text-sky-900"},"Contraseña",-1)),o("div",qe,[u(o("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>c.value=t),type:"password",id:"contrasena",name:"contrasena",placeholder:"Ingresa tu contraseña",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[p,c.value]]),e[24]||(e[24]=o("i",{class:"absolute text-sky-800 fas fa-lock left-3 top-3"},null,-1))])]),o("div",De,[e[27]||(e[27]=o("label",{for:"confirmar-contrasena",class:"block font-medium text-sky-900"},"Confirmar Contraseña",-1)),o("div",Ne,[u(o("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>g.value=t),type:"password",id:"confirmar-contrasena",name:"confirmar-contrasena",placeholder:"Confirma tu contraseña",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[p,g.value]]),e[26]||(e[26]=o("i",{class:"absolute text-sky-800 fas fa-lock left-3 top-3"},null,-1))])]),o("div",Ve,[o("button",{onClick:_(O,["prevent"]),type:"submit",class:"w-full px-3 py-2 text-white bg-blue-500 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"},"Crear Cuenta")])])])])])],64))}}),Se=T({__name:"RegisterView",setup(F){return(n,d)=>(x(),Q(Z,null,{main:X(()=>[ee(Ue)]),_:1}))}});export{Se as default};
