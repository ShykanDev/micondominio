import{d as _,a1 as b,o as d,e as c,a as e,a0 as x,j as v,u as l,m as h,a2 as D,h as m,g as C,q as S,v as N,F as A,a3 as R,c as T}from"./index-D67faS8Z.js";import{N as U}from"./notyf.min-ll9y_k96.js";import{g as j,c as k,a as L,b as q,T as I,u as B,d as F,e as M}from"./index.esm2017-CZwVnIW6.js";import{o as n}from"./ownerVals-Cgb70Twk.js";const V={class:"w-full relative max-w-md p-6 rounded-lg shadow-lg hover:border-[1px] hover:border-slate-700 bg-slate-50"},E={class:"flex items-center mb-4"},O={class:"font-poppins"},P={class:"text-lg font-semibold"},z={key:0,class:"absolute top-2 right-3 text-sky-800 fas fa-user-shield"},H={class:"text-sm text-gray-500"},G={class:"text-sm text-gray-500"},J=["innerHTML"],K={class:"flex items-center justify-between min-w-60"},Q={class:"flex items-center w-full text-gray-500"},W={class:"text-xs"},X={class:"flex items-center justify-end mt-4 space-x-4"},Y=_({__name:"CommentCard",props:{userName:{type:String,required:!1,default:"Daniel Martinez"},userType:{type:String,required:!1,default:"propietario"},comment:{type:String,required:!1,default:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."},date:{type:Object,required:!0},fromAdmin:{type:Boolean,default:!1},isUrgent:{type:Boolean,default:!1}},setup(p){const a=p,f=b(()=>a.userName.includes("administrado")?a.userName.replace(/administrador/gi,"").trim():a.userName.replace(/propietario/gi,"").trim()),g=b(()=>{const r=a.date.toDate();return r.toLocaleDateString()+" "+r.toLocaleTimeString()}),u=b(()=>a.comment.replace(/^(Respuesta a [^:]+:)/,r=>(console.log("Match:",r),`<span class='text-sm italic font-semibold text-sky-800 font-poppins '>${r}</span>`)));return(r,o)=>(d(),c("div",V,[e("div",E,[o[2]||(o[2]=e("i",{class:"mr-3 text-3xl text-gray-500 fas fa-user-circle"},null,-1)),e("div",O,[e("h2",P,x(f.value),1),p.userName.includes("administrador")?(d(),c("i",z)):v("",!0),e("p",H,[e("small",null,"Categoría: "+x(p.userType),1)]),e("p",G,[e("small",null,"Usuario: "+x(p.userName.includes("propietario")?"Propietario":"Administrador"),1)])])]),e("p",{class:"mb-4 text-gray-700 font-poppins",innerHTML:u.value},null,8,J),e("div",K,[e("div",Q,[o[3]||(o[3]=e("i",{class:"mr-1 fas fa-calendar-alt"},null,-1)),e("span",W,"Fecha: "+x(g.value),1)]),e("div",X,[e("button",{onClick:o[0]||(o[0]=y=>l(n)().setShowPopUpAnswerComment(!0,f.value)),class:"px-1 py-[3px] font-signika text-white bg-blue-500 rounded-lg hover:bg-blue-600"}," Responder "),e("button",{onClick:o[1]||(o[1]=y=>l(n)().setShowReportComment(!0)),class:"text-gray-500 hover:text-rose-700"},o[4]||(o[4]=[e("i",{class:"fas fa-flag"},null,-1)]))])])]))}}),Z={class:"flex w-full p-4 mx-auto mt-10 overflow-hidden bg-white rounded-lg shadow-lg justify-evenly"},ee={key:0,class:"fixed top-0 bottom-0 left-0 right-0 z-50 flex items-center justify-center w-full bg-black bg-opacity-65 font-poppins animate-fade animate-duration-300"},te={class:"w-full max-w-md p-6 bg-white rounded-lg shadow-lg animate-fade-up"},se={class:"flex justify-end space-x-4 font-signika"},oe={key:1,class:"fixed left-0 z-40 w-full max-w-md p-6 bg-white border-t-2 border-b-2 border-r-2 rounded-lg shadow-lg bottom-1"},ne={class:"flex items-center mb-4"},ae={class:"text-lg font-bold font-poppins"},re={class:"text-blue-500 underline font-poppins"},ie={class:"flex flex-wrap w-full gap-5 justify-evenly"},ce=_({__name:"CommentComponent",setup(p){const a=new U({duration:6e3,dismissible:!0,position:{x:"left",y:"top"},ripple:!0}),f=h([]),g=j(),u=h(""),r=async()=>{m().setIsLoadingOwner(!0);const i=k(g,`condominios/${m().getAdminDocId}/comments`);try{(await L(i)).forEach(s=>{f.value.push(s.data())}),m().setIsLoadingOwner(!1)}catch(t){console.log(t),m().setIsLoadingOwner(!1)}};D(()=>{r()});const o=k(g,`condominios/${m().getAdminDocId}/comments`),y=async()=>{const i=F(g,"condominios",m().getAdminDocId,"usuarios",n().getUserDataId),t=await M(i);if(t.exists()){if(!t.data().allowComments)return a.error("Error al agregar el comentario, no tienes permiso para comentar en este dominio"),!1}else return console.log("No such document!"),!1;return!0},$=async()=>{try{if(!await y())return;const t=await q(o,{announcement:`Respuesta a ${n().getAnswerCommentTo}: ${u.value}`,author:n().getOwnerName,category:"Respuesta a comentario",date:I.now()});await B(t,{documentId:t.id}),a.success("Se ha respondido el comentario"),u.value="",n().setClosePopUpAnswerComment()}catch(i){console.log(i)}};return(i,t)=>(d(),c("div",Z,[l(n)().getShowReportComment?(d(),c("section",ee,[e("div",te,[t[4]||(t[4]=e("h2",{class:"mb-4 text-xl font-bold"},"¿Deseas enviar el reporte de este comentario al administrador?",-1)),t[5]||(t[5]=e("p",{class:"mb-4 text-sm"},"Si crees que este comentario infringe los términos y condiciones o contiene lenguaje ofensivo, puedes reportarlo al administrador para su revisión.",-1)),e("div",se,[e("button",{onClick:t[0]||(t[0]=s=>l(n)().setShowReportComment(!1)),class:"px-4 py-2 text-gray-700 bg-gray-300 rounded hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50"},"Cancelar"),e("button",{onClick:t[1]||(t[1]=s=>l(n)().setShowReportComment(!1)),class:"px-4 py-2 text-white bg-red-500 rounded hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50"},"Reportar")])])])):v("",!0),l(n)().getShowPopUpAnswerComment?(d(),c("div",oe,[e("i",{onClick:t[2]||(t[2]=s=>l(n)().setClosePopUpAnswerComment()),class:"absolute top-0 text-2xl cursor-pointer right-2 hover:text-sky-300 text-sky-500 fas fa-times",title:"cerrar"}),e("div",ne,[t[7]||(t[7]=e("i",{class:"mr-3 text-3xl text-sky-500 fas fa-comment"},null,-1)),e("div",null,[e("h2",ae,[t[6]||(t[6]=C(" Responder a ")),e("span",re,x(l(n)().getAnswerCommentTo),1)])])]),S(e("textarea",{class:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[3]||(t[3]=s=>u.value=s),placeholder:"Escribe tu respuesta aquí...",rows:"4"},null,512),[[N,u.value]]),e("button",{onClick:$,class:"w-full py-2 mt-4 text-white bg-blue-500 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 font-signika"},t[8]||(t[8]=[e("i",{class:"mr-2 fas fa-paper-plane"},null,-1),C(" Enviar ")]))])):v("",!0),e("section",ie,[(d(!0),c(A,null,R(f.value.sort((s,w)=>w.date-s.date),(s,w)=>(d(),T(Y,{key:w,comment:s.announcement,date:s.date,"from-admin":s.fromAdmin,"is-urgent":i.isUrgent,"user-name":s.author,"user-type":s.category},null,8,["comment","date","from-admin","is-urgent","user-name","user-type"]))),128))])]))}});export{ce as default};
