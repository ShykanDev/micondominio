import{d as k,r as u,s as h,o as I,f as C,e as c,a3 as D,k as T,a as t,n as a,j as A,v as p,a5 as E,F as V,i as B}from"./index-B3vvVhEK.js";import{g as F,c as U,T as S,b as _,u as $}from"./index.esm2017-waQ9Feby.js";import{_ as N}from"./AnnouncementCard.vue_vue_type_script_setup_true_lang-BjnYbcfM.js";const j={class:"max-w-4xl p-6 mx-auto mt-10 bg-white rounded-lg shadow-md font-poppins"},M={class:"mb-4"},P={class:"mb-4"},K={class:"mb-4"},O={class:"grid w-full max-w-xs items-center gap-1.5"},R={class:"flex items-center mt-3 mb-4"},q=k({__name:"AnnouncementComponent",setup(z){const l=u(""),s=u(""),r=u(!1),i=u(""),d=u(null),b=n=>{const e=n.target;e.files&&e.files[0]&&(d.value=e.files[0])},v=async n=>{const o="https://api.imgbb.com/1/upload?key=604279d0c28a117c1c79e497b58a66ea";try{const f=new FormData;f.append("image",n);const m=await fetch(o,{method:"POST",body:f});if(!m.ok)throw new Error(`Error en la solicitud: ${m.statusText}`);const g=await m.json();if(!g.success)throw new Error(`Error en la respuesta de ImgBB: ${g.error.message}`);return g.data.url}catch(f){return console.error("Error subiendo la imagen:",f),null}},x=F(),y=U(x,`condominios/${h().getCondominiumId}/announcements`),w=async()=>{if(!d.value){alert("Por favor selecciona una imagen.");return}const n=await v(d.value);if(!n){alert("Error al subir la imagen.");return}const e={title:l.value,description:s.value,category:i.value,urgent:r.value,imageUrl:n,creationDate:S.now()},o=await _(y,e);await $(o,{announcementId:o.id}),l.value="",s.value="",i.value="",d.value=null,r.value=!1,console.log("Anuncio creado con ID:",n)};return(n,e)=>(I(),C(V,null,[c(T(N,{class:"fixed shadow-2xl bottom-3 left-3",title:l.value,description:s.value,date:new Date().toDateString(),category:i.value,"is-urgent":r.value},null,8,["title","description","date","category","is-urgent"]),[[D,l.value]]),t("section",j,[e[10]||(e[10]=t("h2",{class:"mb-4 text-2xl font-bold text-sky-800"},[t("i",{class:"fas fa-bullhorn"}),a(" Nuevo Anuncio")],-1)),t("form",{onSubmit:A(w,["prevent"])},[t("div",M,[e[4]||(e[4]=t("label",{for:"titulo",class:"block mb-2 font-bold text-sky-800"},[t("i",{class:"fas fa-heading"}),a(" Título del Anuncio")],-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.value=o),type:"text",id:"titulo",name:"titulo",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese el título del anuncio"},null,512),[[p,l.value]])]),t("div",P,[e[5]||(e[5]=t("label",{for:"category",class:"block mb-2 font-bold text-sky-800"},[t("i",{class:"fas fa-tag"}),a(" Categoría del Anuncio")],-1)),c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>i.value=o),type:"text",id:"category",name:"category",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la categoría del anuncio e.g. Pago de mantenimiento, etc."},null,512),[[p,i.value]])]),t("div",K,[e[6]||(e[6]=t("label",{for:"descripcion",class:"block mb-2 font-bold text-sky-800"},[t("i",{class:"fas fa-align-left"}),a(" Descripción")],-1)),c(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.value=o),id:"descripcion",name:"descripcion",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ingrese la descripción del anuncio"},null,512),[[p,s.value]])]),t("div",O,[e[7]||(e[7]=t("label",{class:"text-sm font-medium leading-none text-gray-400 peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},[t("i",{class:"mr-2 fas fa-image text-sky-600"}),a(" Imagen")],-1)),t("input",{class:"flex w-full text-sm text-gray-400 bg-white border border-blue-300 rounded-md border-input file:border-0 file:bg-blue-600 file:text-white file:text-sm file:font-medium",type:"file",id:"picture",onChange:b},null,32)]),t("div",R,[c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o),type:"checkbox",id:"urgente",name:"urgente",class:"mr-2"},null,512),[[E,r.value]]),e[8]||(e[8]=t("label",{for:"urgente",class:"font-bold text-sky-800"},[t("i",{class:"fas fa-exclamation-circle"}),a(" ¿Es Urgente?")],-1))]),e[9]||(e[9]=t("div",{class:"flex justify-end"},[t("button",{type:"submit",class:"px-4 py-2 text-white bg-blue-500 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"},[t("i",{class:"fas fa-plus"}),a(" Crear Anuncio ")])],-1))],32)])],64))}}),L=B(q,[["__scopeId","data-v-c875abfa"]]);export{L as default};
