import{d as W,l as i,G as ee,N as oe,m as te,p as ne,y as c,H as se,q as ae,o as x,b as C,a as o,e as ie,i as V,t as d,v as m,I as le,g,x as re,h as J,w as K,F as de,B as F,J as y,T as I,K as w,z as ue,A as ce,c as me,M as fe}from"./index-BwM74EYG.js";import{g as pe,c as H,u as O,b as z}from"./index-2cab5241-FfdGktIA.js";const ve={class:"font-roboto font-poppins"},be={key:0,class:"fixed top-0 bottom-0 left-0 right-0 z-40 flex flex-col items-center justify-center transition-opacity duration-500 ease-in-out bg-white bg-opacity-100 animate-fade"},ge={class:"flex items-center justify-center px-3 py-2 bg-white bg-opacity-50"},ye={class:"w-full max-w-4xl p-8 bg-white rounded-lg shadow-lg"},we={class:"mb-4"},xe={class:"relative"},ke={class:"mb-4"},Ce={class:"relative"},Ie={key:0,class:"mb-4 animate-fade-up"},De={class:"relative"},Re={key:1,class:"mb-4 animate-fade-up"},qe={class:"relative"},Ne={key:2,class:"mb-4 animate-fade-up"},Ve={class:"relative"},Ae={class:"mb-4"},Ue={class:"relative"},Be={class:"mb-4"},Me={class:"relative"},Se={class:"mb-4"},Te={class:"relative"},he={class:"mb-6"},Le={class:"text-center"},Pe=W({__name:"RegisterCard",setup(Y){const l=i(!1),A=ee(),r=new oe({position:{x:"center",y:"top"},dismissible:!0,duration:5e3}),f=i(""),k=i(""),s=i(""),U=i(""),p=i(""),D=i(""),B=i(""),R=i(""),T=pe(),u=te(),q=i(""),h=ne(),Q=()=>{const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let v=0;v<8;v++){const t=Math.floor(Math.random()*n.length);e+=n.charAt(t)}return e},L=c(u,"condominios"),P=()=>!f.value||!k.value||!p.value||!D.value||!s.value?(r.error("Por favor, completa todos los campos."),!1):p.value!==D.value?(r.error("Las contraseñas no coinciden."),!1):!0,X=async()=>{try{if(!P())return;if(l.value=!0,B.value=Q(),(await F(L)).docs.map(a=>a.data()).some(a=>a.invitationId===B.value)){r.error("Error al generar el ID de invitación. Inténtelo de nuevo."),l.value=!1;return}const t=(await H(T,k.value,p.value)).user;if(t){await O(t,{displayName:`${s.value} ${f.value}`}),await z(t);const a=await y(c(u,"condominios"),{name:U.value,createdBy:t.uid,type:s.value,invitationId:B.value,dateCreated:I.now(),condominiumId:""});await w(a,{condominiumId:a.id});const M=c(u,`condominios/${a.id}/announcements`),N=c(u,`condominios/${a.id}/comments`),S=c(u,`condominios/${a.id}/surveys`),b=await y(M,{title:"Bienvenidos",content:"Este es el primer anuncio de tu condominio.",author:t.displayName,date:new Date,isUrgent:!1,fromAdmin:!1});await w(b,{announcementId:b.id});const j=await y(N,{announcement:"Primer comentario generado automáticamente",category:"Inquilinos",date:I.now(),author:t.displayName,isUrgent:!1,fromAdmin:!1});await w(j,{documentId:j.id});const G=await y(S,{title:"Encuesta de prueba",description:"Esta es una encuesta de prueba, sus inquilinos podrán votar en ella.",options:["Opción 1","Opción 2","Opción 3"],createdBy:t.uid,creationDate:I.now()});await w(G,{surveyDocId:G.id}),r.success({message:"Registro exitoso. Por favor, verifica tu correo electrónico.",duration:7e3})}h.push("/login")}catch(n){console.error(n),r.error(n.message)}finally{l.value=!1}},Z=async()=>{try{if(!P())return;l.value=!0;const n=ue(L,ce("invitationId","==",q.value.trim())),e=await F(n);if(e.empty){r.error("Código de invitación no encontrado."),l.value=!1;return}const t=(await H(T,k.value,p.value)).user;if(t){await O(t,{displayName:`${s.value} ${f.value}`}),await z(t);const a=c(u,"usersGeneral"),M=await y(a,{deptNumber:R.value,creationDate:I.now(),userUid:t.uid,asociatedTo:e.docs[0].data().createdBy,invitationCode:e.docs[0].data().invitationId,asociatedToCondominiumId:e.docs[0].data().condominiumId});for(const N of e.docs){const S=c(u,`condominios/${N.id}/usuarios`),b=await y(S,{name:f.value,deptNumber:R.value,creationDate:I.now(),isBlocked:!1,blockedReason:"",allowComments:!0,userUid:t.uid,associatedTo:N.data().createdBy});await w(b,{docId:b.id}),await w(M,{userDataId:b.id})}r.success({message:"Registro exitoso. Por favor, verifica tu correo electrónico.",duration:7e3})}h.push("/login")}catch(n){console.error(n),r.error(n.message)}finally{l.value=!1}},_=n=>{switch(n.toLowerCase()){case"administrador":X();break;case"propietario":Z();break}},$=A.query.tipoCuenta||"",E=A.query.codigoInvitacion||"  ";return console.log("Tipo de cuenta:",$),console.log("Código de invitación:",E),se(()=>{q.value=String(E),s.value=String($)}),(n,e)=>{const v=ae("RouterLink");return x(),C(de,null,[e[32]||(e[32]=o("img",{src:"https://images.unsplash.com/photo-1576961453646-b4c376c7021b?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",class:"fixed top-0 bottom-0 left-0 right-0 object-cover w-full h-full animate-fade -z-10",alt:"A scenic view of a modern building with a clear sky in the background"},null,-1)),o("section",ve,[l.value?(x(),C("section",be,e[9]||(e[9]=[ie('<p class="text-2xl font-semibold text-sky-800 font-poppins">Creando Cuenta <span class="animate-pulse animate-delay-0">.</span> <span class="animate-pulse animate-delay-300">.</span> <span class="animate-pulse animate-delay-400">.</span></p><div class="flex flex-col items-center justify-center w-full gap-4"><div class="flex items-center justify-center text-4xl text-blue-400 border-8 border-gray-300 rounded-full w-28 h-28 animate-spin border-t-blue-400"></div></div>',2)]))):V("",!0),o("div",ge,[o("div",ye,[e[31]||(e[31]=o("h2",{class:"mb-6 text-4xl font-bold text-center text-sky-900"},"Crear una Cuenta",-1)),o("form",null,[o("div",we,[e[11]||(e[11]=o("label",{for:"nombre",class:"block font-medium text-sky-900"},"Nombre",-1)),o("div",xe,[d(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),type:"text",id:"nombre",name:"nombre",placeholder:"Ingresa tu nombre",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,f.value]]),e[10]||(e[10]=o("i",{class:"absolute text-sky-800 fas fa-user left-3 top-3"},null,-1))])]),o("div",ke,[e[14]||(e[14]=o("label",{for:"tipo-cuenta",class:"block font-medium text-sky-900"},"Tipo de Cuenta",-1)),o("div",Ce,[d(o("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.value=t),id:"tipo-cuenta",name:"tipo-cuenta",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},e[12]||(e[12]=[o("option",{value:"",disabled:"",selected:""},"Selecciona el tipo de cuenta",-1),o("option",{value:"propietario"},"Propietario/Inquilino",-1),o("option",{value:"administrador"},"Administrador",-1)]),512),[[le,s.value]]),e[13]||(e[13]=o("i",{class:"absolute text-sky-800 fas fa-user-tag left-3 top-3"},null,-1))]),e[15]||(e[15]=o("div",{class:"mt-2 text-sm text-gray-600"},[o("i",{class:"mr-1 fas fa-info-circle"}),g(" La cuenta por defecto es de "),o("strong",null,"Propietario/Inquilino"),g(". Seleccione "),o("strong",null,"Administrador"),g(" si usted es responsable de la administración de un edificio o condominio. ")],-1))]),s.value.toLowerCase()=="propietario"?(x(),C("div",Ie,[e[17]||(e[17]=o("label",{for:"owner",class:"block font-medium text-sky-900"},"Número de departamento",-1)),o("div",De,[d(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>R.value=t),type:"email",id:"owner",name:"owner",placeholder:"Ingresa el número de departamento",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,R.value]]),e[16]||(e[16]=o("i",{class:"absolute text-sky-800 fas fa-hashtag left-3 top-3"},null,-1))])])):V("",!0),s.value.toLowerCase()=="propietario"?(x(),C("div",Re,[e[19]||(e[19]=o("label",{for:"invId",class:"block font-medium text-sky-900"},"Código de invitación",-1)),o("div",qe,[d(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>q.value=t),type:"email",id:"invId",name:"invId",placeholder:"Ingresa el código de invitación",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,q.value]]),e[18]||(e[18]=o("i",{class:"absolute text-sky-800 fas fa-address-card left-3 top-3"},null,-1))]),e[20]||(e[20]=o("div",null,[o("small",{class:"text-xs italic text-slate-500"},[o("i",{class:"mr-1 fas fa-info-circle"}),g("Ingresa el código de invitación de tu departamento, pregunta al administrador, por el código.")])],-1))])):V("",!0),s.value.toLowerCase()=="administrador"?(x(),C("div",Ne,[e[22]||(e[22]=o("label",{for:"condominium",class:"block font-medium text-sky-900"},"Nombre del Condominio",-1)),o("div",Ve,[d(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>U.value=t),type:"email",id:"condominium",name:"condominium",placeholder:"Ingresa el nombre del condominio ",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,U.value]]),e[21]||(e[21]=o("i",{class:"absolute text-sky-800 fas fa-building left-3 top-3"},null,-1))])])):V("",!0),o("div",Ae,[e[24]||(e[24]=o("label",{for:"correo",class:"block font-medium text-sky-900"},"Correo Electrónico",-1)),o("div",Ue,[d(o("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>k.value=t),type:"email",id:"correo",name:"correo",placeholder:"Ingresa tu correo electrónico",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,k.value]]),e[23]||(e[23]=o("i",{class:"absolute text-sky-800 fas fa-envelope left-3 top-3"},null,-1))])]),o("div",Be,[e[26]||(e[26]=o("label",{for:"contrasena",class:"block font-medium text-sky-900"},"Contraseña",-1)),o("div",Me,[d(o("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>p.value=t),type:"password",id:"contrasena",name:"contrasena",placeholder:"Ingresa tu contraseña",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,p.value]]),e[25]||(e[25]=o("i",{class:"absolute text-sky-800 fas fa-lock left-3 top-3"},null,-1))])]),o("div",Se,[e[28]||(e[28]=o("label",{for:"confirmar-contrasena",class:"block font-medium text-sky-900"},"Confirmar Contraseña",-1)),o("div",Te,[d(o("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>D.value=t),type:"password",id:"confirmar-contrasena",name:"confirmar-contrasena",placeholder:"Confirma tu contraseña",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,D.value]]),e[27]||(e[27]=o("i",{class:"absolute text-sky-800 fas fa-lock left-3 top-3"},null,-1))])]),o("div",he,[o("button",{onClick:e[8]||(e[8]=re(t=>_(s.value),["prevent"])),type:"submit",class:"w-full px-3 py-2 text-white bg-blue-500 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"},"Crear Cuenta")]),o("div",null,[o("p",Le,[e[30]||(e[30]=g("¿Necesitas Ayuda? ")),J(v,{class:"text-sky-600",to:{name:"help"}},{default:K(()=>e[29]||(e[29]=[g(" Como Crear Cuenta")])),_:1})])])])])])])],64)}}}),je=W({__name:"RegisterView",setup(Y){return(l,A)=>(x(),me(fe,null,{main:K(()=>[J(Pe)]),_:1}))}});export{je as default};
