import{d as h,N as E,l as q,ai as N,m as U,o as f,b as x,a as o,g as c,ag as u,n as p,i as L,f as s,D as y,K as b,y as v,z as I,A as B,B as D,_ as z,H as R,F,aj as G,c as O}from"./index-BwM74EYG.js";const V={class:"w-full max-w-xs p-6 rounded-lg shadow-md font-poppins bg-slate-50 animate-fade"},$={class:"flex items-center mb-4"},j={class:"ml-4"},T={class:"font-medium text-gray-600 text-md"},H={class:"text-sky-700"},A={class:"text-gray-800"},M={class:"text-sky-700"},K={class:"text-gray-800"},J={class:"text-sky-700"},P={class:"flex flex-col items-start justify-between"},Q={class:"flex space-x-2"},W={class:"flex items-center mt-2 space-x-2"},X={class:"flex my-3 space-x-2"},Y={key:0,class:"flex items-center mt-2 space-x-2"},Z={class:"text-xs"},_=h({__name:"UserCard",props:{name:{type:String,default:"Daniel Martinez"},deptNumber:{type:String,default:"22a"},creationDate:{type:Object},allowComments:{type:Boolean,default:!0},associatedTo:{type:String,default:""},blockedReason:{type:String,default:""},isBlocked:{type:Boolean,default:!1},userUid:{type:String,required:!0},docId:{type:String,required:!0}},setup(t){const n=new E({duration:4e3,dismissible:!0,position:{x:"left",y:"top"},ripple:!0}),d=t,C=q("Este usuario está bloqueado y no puede participar, su cuenta ha sido bloqueada en el sistema para su condominio, el usuario aún puede comentar en la pagina administracioncondominio.com, pero no podrá hacerlo en su condominio."),w=N(()=>{if(d.creationDate){const i=d.creationDate.toDate();return i.toLocaleDateString()+" "+i.toLocaleTimeString()}return d.creationDate}),a=U(),g=async i=>{s().setIsLoadingComponent(!0);const e=s().getCondominiumId;if(!e){n.error("ID del condominio no encontrado"),s().setIsLoadingComponent(!1);return}const l=y(a,"condominios",e,"usuarios",d.docId);try{await b(l,{allowComments:!d.allowComments}),s().setIsLoadingComponent(!1),n.success("Operación realizada")}catch(m){console.log(m),s().setIsLoadingComponent(!1),n.error("Error en la operacion, intentelo de nuevo")}finally{s().setIsLoadingComponent(!1)}},r=async()=>{s().setIsLoadingComponent(!0);try{const i=v(a,"usersGeneral"),e=I(i,B("userUid","==",d.userUid)),l=await D(e);if(l.empty){n.error("Usuario no encontrado"),s().setIsLoadingComponent(!1);return}else{console.log("Valores:"),console.log(l.docs[0].data());const m=y(a,"usersGeneral",l.docs[0].id);await b(m,{isBlocked:!l.docs[0].data().isBlocked});const S=y(a,"condominios",s().getCondominiumId,"usuarios",d.docId);await b(S,{isBlocked:!l.docs[0].data().isBlocked}),s().setIsLoadingComponent(!1),n.success("Operación realizada")}}catch(i){console.log(i)}},k=async()=>{s().setIsLoadingComponent(!0);try{const i=v(a,"usersGeneral"),e=I(i,B("userUid","==",d.userUid)),l=await D(e);if(l.empty){n.error("Usuario no encontrado"),s().setIsLoadingComponent(!1);return}else{const m=y(a,"usersGeneral",l.docs[0].id);await b(m,{invitationCode:s().getInvitationCode}),n.success("Operación realizada"),s().setIsLoadingComponent(!1)}}catch(i){console.log(i),s().setIsLoadingComponent(!1),n.error("Error en la operacion, intentelo de nuevo")}};return(i,e)=>(f(),x("div",V,[o("div",$,[e[7]||(e[7]=o("i",{class:"text-4xl text-gray-500 fas fa-user-circle"},null,-1)),o("div",j,[o("h2",T,[e[1]||(e[1]=o("i",{class:"fas fa-user"},null,-1)),e[2]||(e[2]=c(" Nombre del Usuario: ")),o("span",H,u(t.name),1)]),o("p",A,[e[3]||(e[3]=o("i",{class:"fas fa-building"},null,-1)),e[4]||(e[4]=c(" Departamento: ")),o("span",M,u(t.deptNumber),1)]),o("p",K,[e[5]||(e[5]=o("i",{class:"fas fa-calendar-alt"},null,-1)),e[6]||(e[6]=c(" Fecha que se unió el usuario: ")),o("span",J,u(w.value),1)])])]),o("div",P,[o("div",Q,[e[8]||(e[8]=o("p",null,[o("i",{class:"fas fa-comments"}),c(" Comentarios:")],-1)),o("p",{class:p(["px-1 text-white rounded",t.allowComments?"bg-green-600":"bg-red-600"])},u(t.allowComments?"Habilitados":"Deshabilitados"),3)]),o("div",W,[e[9]||(e[9]=o("i",{class:"text-lg text-gray-500 fas fa-info-circle"},null,-1)),o("p",null,u(t.allowComments?"Este usuario puede comentar libremente":"Este usuario no puede comentar."),1)]),o("div",X,[e[11]||(e[11]=o("p",null,[o("i",{class:"fas fa-user-shield"}),c(" Estado: ")],-1)),o("p",{class:p(["px-1 text-white rounded",t.isBlocked?"bg-red-600":"bg-green-600"])},[c(u(t.isBlocked?"Bloqueado":"Desbloqueado")+" ",1),e[10]||(e[10]=o("span",{class:"w-5 h-5 animate-duration-[5s] animate-ping rounded-full font-signika"},"•",-1))],2)])]),o("button",{onClick:r,class:p(["px-4 py-2 mt-2 text-white rounded-lg focus:outline-none focus:ring-2",t.isBlocked?"bg-green-500 hover:bg-green-700 focus:ring-green-500":"bg-red-800 hover:bg-red-700 focus:ring-red-500"])},u(t.isBlocked?"Desbloquear":"Bloquear"),3),o("button",{onClick:e[0]||(e[0]=l=>g()),class:p(["px-4 py-2 mt-2 text-sm text-white rounded-lg focus:outline-none focus:ring-2",t.allowComments?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-yellow-600 hover:bg-red-700 focus:ring-red-500"])},u(t.allowComments?"Deshabilitar Comentarios":"Habilitar Comentarios"),3),o("button",{onClick:k,class:"px-4 py-2 mt-2 text-sm text-white rounded-lg bg-slate-600 hover:bg-blue-700 focus:ring-blue-500 focus:outline-none focus:ring-2"},e[12]||(e[12]=[o("i",{class:"mr-2 fas fa-redo"},null,-1),c(" Renovar Acceso ")])),e[14]||(e[14]=o("small",{class:"flex items-start mt-2 text-gray-500"},[o("i",{class:"mr-2 mt-[2px] fas fa-info-circle"}),c(" Este botón actualiza el código de invitación para el usuario. Úselo solo si el usuario no puede acceder con su código anterior, ya que este código reemplazará el existente. ")],-1)),t.isBlocked?(f(),x("div",Y,[o("p",Z,[e[13]||(e[13]=o("i",{class:"text-lg text-gray-500 fas fa-info-circle"},null,-1)),c(" "+u(t.isBlocked?`${C.value}`:""),1)])])):L("",!0)]))}}),ee=z(_,[["__scopeId","data-v-1e5035f4"]]),oe={key:0,class:"flex flex-wrap items-center py-2 space-y-3 bg-white rounded-lg shadow-md justify-evenly"},te=h({__name:"UsersComponent",setup(t){const n=q([]),d=U(),C=v(d,`condominios/${s().getCondominiumId}/usuarios`),w=async()=>{try{const a=await D(C);if(a.empty){console.log("No se encontraron usuarios");return}else a.forEach(g=>{n.value.push(g.data())})}catch(a){console.log(a)}};return R(()=>{w()}),(a,g)=>n.value?(f(),x("div",oe,[(f(!0),x(F,null,G(n.value,(r,k)=>(f(),O(ee,{key:k,"allow-comments":r.allowComments,name:r.name,"associated-to":r.associatedTo,"blocked-reason":r.blockedReason,"creation-date":r.creationDate,"dept-number":r.deptNumber,"is-blocked":r.isBlocked,"user-uid":r.userUid,"doc-id":r.docId},null,8,["allow-comments","name","associated-to","blocked-reason","creation-date","dept-number","is-blocked","user-uid","doc-id"]))),128))])):L("",!0)}});export{te as default};
