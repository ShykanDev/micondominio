import{d as G,m as l,p as J,o as w,e as k,a as o,f as K,j as N,q as u,v as m,x as Q,g as R,t as X,F as Z,c as _,w as ee,_ as oe,i as te}from"./index-TFeQVYrp.js";import{g as ae,c as M,u as j,a as L}from"./index-2cab5241-DCtVy1C3.js";import{g as se,c as f,a as F,b as g,T as C,u as y,q as ne,w as ie}from"./index.esm2017-DkIOf4jH.js";import{N as le}from"./notyf.min-ll9y_k96.js";const re={class:"font-roboto font-poppins"},de={key:0,class:"fixed top-0 bottom-0 left-0 right-0 z-40 flex flex-col items-center justify-center transition-opacity duration-500 ease-in-out bg-white bg-opacity-100 animate-fade"},ue={class:"flex items-center justify-center px-3 py-2 bg-white bg-opacity-50"},ce={class:"w-full max-w-4xl p-8 bg-white rounded-lg shadow-lg"},me={class:"mb-4"},fe={class:"relative"},pe={class:"mb-4"},ve={class:"relative"},be={key:0,class:"mb-4 animate-fade-up"},ge={class:"relative"},ye={key:1,class:"mb-4 animate-fade-up"},we={class:"relative"},xe={key:2,class:"mb-4 animate-fade-up"},ke={class:"relative"},Ce={class:"mb-4"},Ie={class:"relative"},De={class:"mb-4"},qe={class:"relative"},Ne={class:"mb-4"},Re={class:"relative"},Ve={class:"mb-6"},Ue=G({__name:"RegisterCard",setup(O){const d=l(!1),r=new le({position:{x:"center",y:"top"},dismissible:!0,duration:5e3}),p=l(""),x=l(""),i=l(""),V=l(""),v=l(""),I=l(""),U=l(""),D=l(""),P=ae(),c=se(),A=l("");J();const H=()=>{const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let t=0;t<8;t++){const a=Math.floor(Math.random()*s.length);e+=s.charAt(a)}return e},S=f(c,"condominios"),T=()=>!p.value||!x.value||!v.value||!I.value||!i.value?(r.error("Por favor, completa todos los campos."),!1):v.value!==I.value?(r.error("Las contraseñas no coinciden."),!1):!0,z=async()=>{try{if(!T())return;if(d.value=!0,U.value=H(),(await F(S)).docs.map(n=>n.data()).some(n=>n.invitationId===U.value)){r.error("Error al generar el ID de invitación. Inténtelo de nuevo."),d.value=!1;return}const a=(await M(P,x.value,v.value)).user;if(a){await j(a,{displayName:`${i.value} ${p.value}`}),await L(a);const n=await g(f(c,"condominios"),{name:V.value,createdBy:a.uid,type:i.value,invitationId:U.value,dateCreated:C.now(),condominiumId:""});await y(n,{condominiumId:n.id});const B=f(c,`condominios/${n.id}/announcements`),q=f(c,`condominios/${n.id}/comments`),$=f(c,`condominios/${n.id}/surveys`),b=await g(B,{title:"Bienvenidos",content:"Este es el primer anuncio de tu condominio.",author:a.displayName,date:new Date,isUrgent:!1,fromAdmin:!1});await y(b,{announcementId:b.id});const h=await g(q,{announcement:"Primer comentario generado automáticamente",category:"Inquilinos",date:C.now(),author:a.displayName,isUrgent:!1,fromAdmin:!1});await y(h,{documentId:h.id});const E=await g($,{title:"Encuesta de prueba",description:"Esta es una encuesta de prueba, sus inquilinos podrán votar en ella.",options:["Opción 1","Opción 2","Opción 3"],createdBy:a.uid,creationDate:C.now()});await y(E,{surveyDocId:E.id}),r.success({message:"Registro exitoso. Por favor, verifica tu correo electrónico.",duration:7e3})}}catch(s){console.error(s),r.error(s.message)}finally{d.value=!1}},W=async()=>{try{if(!T())return;d.value=!0;const s=ne(S,ie("invitationId","==",A.value.trim())),e=await F(s);if(e.empty){r.error("Código de invitación no encontrado."),d.value=!1;return}const a=(await M(P,x.value,v.value)).user;if(a){await j(a,{displayName:`${i.value} ${p.value}`}),await L(a);const n=f(c,"usersGeneral"),B=await g(n,{deptNumber:D.value,creationDate:C.now(),userUid:a.uid,asociatedTo:e.docs[0].data().createdBy,invitationCode:e.docs[0].data().invitationId,asociatedToCondominiumId:e.docs[0].data().condominiumId});for(const q of e.docs){const $=f(c,`condominios/${q.id}/usuarios`),b=await g($,{name:p.value,deptNumber:D.value,creationDate:C.now(),isBlocked:!1,blockedReason:"",allowComments:!0,userUid:a.uid,associatedTo:q.data().createdBy});await y(b,{docId:b.id}),await y(B,{userDataId:b.id})}r.success({message:"Registro exitoso. Por favor, verifica tu correo electrónico.",duration:7e3})}}catch(s){console.error(s),r.error(s.message)}finally{d.value=!1}},Y=s=>{switch(s.toLowerCase()){case"administrador":z();break;case"propietario":W();break}};return(s,e)=>(w(),k(Z,null,[e[30]||(e[30]=o("img",{src:"https://images.unsplash.com/photo-1576961453646-b4c376c7021b?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",class:"fixed top-0 bottom-0 left-0 right-0 object-cover w-full h-full animate-fade -z-10",alt:"A scenic view of a modern building with a clear sky in the background"},null,-1)),o("section",re,[d.value?(w(),k("section",de,e[9]||(e[9]=[K('<p class="text-2xl font-semibold text-sky-800 font-poppins">Creando Cuenta <span class="animate-pulse animate-delay-0">.</span> <span class="animate-pulse animate-delay-300">.</span> <span class="animate-pulse animate-delay-400">.</span></p><div class="flex flex-col items-center justify-center w-full gap-4"><div class="flex items-center justify-center text-4xl text-blue-400 border-8 border-gray-300 rounded-full w-28 h-28 animate-spin border-t-blue-400"></div></div>',2)]))):N("",!0),o("div",ue,[o("div",ce,[e[29]||(e[29]=o("h2",{class:"mb-6 text-4xl font-bold text-center text-sky-900"},"Crear una Cuenta",-1)),o("form",null,[o("div",me,[e[11]||(e[11]=o("label",{for:"nombre",class:"block font-medium text-sky-900"},"Nombre",-1)),o("div",fe,[u(o("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),type:"text",id:"nombre",name:"nombre",placeholder:"Ingresa tu nombre",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,p.value]]),e[10]||(e[10]=o("i",{class:"absolute text-sky-800 fas fa-user left-3 top-3"},null,-1))])]),o("div",pe,[e[14]||(e[14]=o("label",{for:"tipo-cuenta",class:"block font-medium text-sky-900"},"Tipo de Cuenta",-1)),o("div",ve,[u(o("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>i.value=t),id:"tipo-cuenta",name:"tipo-cuenta",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},e[12]||(e[12]=[o("option",{value:"",disabled:"",selected:""},"Selecciona el tipo de cuenta",-1),o("option",{value:"propietario"},"Propietario/Inquilino",-1),o("option",{value:"administrador"},"Administrador",-1)]),512),[[Q,i.value]]),e[13]||(e[13]=o("i",{class:"absolute text-sky-800 fas fa-user-tag left-3 top-3"},null,-1))]),e[15]||(e[15]=o("div",{class:"mt-2 text-sm text-gray-600"},[o("i",{class:"mr-1 fas fa-info-circle"}),R(" La cuenta por defecto es de "),o("strong",null,"Propietario/Inquilino"),R(". Seleccione "),o("strong",null,"Administrador"),R(" si usted es responsable de la administración de un edificio o condominio. ")],-1))]),i.value.toLowerCase()=="propietario"?(w(),k("div",be,[e[17]||(e[17]=o("label",{for:"owner",class:"block font-medium text-sky-900"},"Número de departamento",-1)),o("div",ge,[u(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>D.value=t),type:"email",id:"owner",name:"owner",placeholder:"Ingresa el número de departamento",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,D.value]]),e[16]||(e[16]=o("i",{class:"absolute text-sky-800 fas fa-hashtag left-3 top-3"},null,-1))])])):N("",!0),i.value.toLowerCase()=="propietario"?(w(),k("div",ye,[e[19]||(e[19]=o("label",{for:"invId",class:"block font-medium text-sky-900"},"Código de invitación",-1)),o("div",we,[u(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>A.value=t),type:"email",id:"invId",name:"invId",placeholder:"Ingresa el código de invitación",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,A.value]]),e[18]||(e[18]=o("i",{class:"absolute text-sky-800 fas fa-address-card left-3 top-3"},null,-1))]),e[20]||(e[20]=o("div",null,[o("small",{class:"text-xs italic text-slate-500"},[o("i",{class:"mr-1 fas fa-info-circle"}),R("Ingresa el código de invitación de tu departamento, pregunta al administrador, por el código.")])],-1))])):N("",!0),i.value.toLowerCase()=="administrador"?(w(),k("div",xe,[e[22]||(e[22]=o("label",{for:"condominium",class:"block font-medium text-sky-900"},"Nombre del Condominio",-1)),o("div",ke,[u(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>V.value=t),type:"email",id:"condominium",name:"condominium",placeholder:"Ingresa el nombre del condominio ",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,V.value]]),e[21]||(e[21]=o("i",{class:"absolute text-sky-800 fas fa-building left-3 top-3"},null,-1))])])):N("",!0),o("div",Ce,[e[24]||(e[24]=o("label",{for:"correo",class:"block font-medium text-sky-900"},"Correo Electrónico",-1)),o("div",Ie,[u(o("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>x.value=t),type:"email",id:"correo",name:"correo",placeholder:"Ingresa tu correo electrónico",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,x.value]]),e[23]||(e[23]=o("i",{class:"absolute text-sky-800 fas fa-envelope left-3 top-3"},null,-1))])]),o("div",De,[e[26]||(e[26]=o("label",{for:"contrasena",class:"block font-medium text-sky-900"},"Contraseña",-1)),o("div",qe,[u(o("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>v.value=t),type:"password",id:"contrasena",name:"contrasena",placeholder:"Ingresa tu contraseña",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,v.value]]),e[25]||(e[25]=o("i",{class:"absolute text-sky-800 fas fa-lock left-3 top-3"},null,-1))])]),o("div",Ne,[e[28]||(e[28]=o("label",{for:"confirmar-contrasena",class:"block font-medium text-sky-900"},"Confirmar Contraseña",-1)),o("div",Re,[u(o("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>I.value=t),type:"password",id:"confirmar-contrasena",name:"confirmar-contrasena",placeholder:"Confirma tu contraseña",class:"w-full px-3 py-2 pl-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:""},null,512),[[m,I.value]]),e[27]||(e[27]=o("i",{class:"absolute text-sky-800 fas fa-lock left-3 top-3"},null,-1))])]),o("div",Ve,[o("button",{onClick:e[8]||(e[8]=X(t=>Y(i.value),["prevent"])),type:"submit",class:"w-full px-3 py-2 text-white bg-blue-500 rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"},"Crear Cuenta")])])])])])],64))}}),Se=G({__name:"RegisterView",setup(O){return(d,r)=>(w(),_(oe,null,{main:ee(()=>[te(Ue)]),_:1}))}});export{Se as default};
